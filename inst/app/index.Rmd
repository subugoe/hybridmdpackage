---
title: "Metacheck input"
output: 
  flexdashboard::flex_dashboard:
    css: !expr subugoetheme::pkgdown_template()$assets$css
runtime: shiny
---

```{r global, include=FALSE}
library(shiny)
library(metacheck)
```


```{r}
biblids::doiEntryUI(id = "dois")
emailReportUI(id = "send")
```

```{r}
# used to disambiguate excel file names
# TODO replace with shiny session id #83
session_id <- as.character(floor(runif(1) * 1e20))

# get dois
dois <- biblids::doiEntryServer(id = "dois")

report <- reactive({
  withProgress(
      expr = render_email(dois = dois(), session_id = session_id),
      message = "Generating report..."
    )
})

# email
emailReportServer(id = "send", dois = dois, email = report())
```
